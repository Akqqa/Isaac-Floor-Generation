<!DOCTYPE html>
<html lang="en" style="scrollbar-gutter: stable;">
  <head>
    <title>Secret Roomle</title>
    <link rel="icon" href="images/secretRoom.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css">
  </head>
  <body id="body" style="color: black; background-repeat: no-repeat; background-size: cover; background-attachment: fixed; background-position: center; overflow-x: hidden; backdrop-filter: blur(2.4px);">
    <script src="//cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"></script> 
    <div style="display: flex; justify-content: center;  font-family: Upheaval; align-items: center; padding: 0.5rem;"> <!-- Div to get everything vertically in the center  -->
      <div id="howToPlayModal" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <h1 style="color:white;font-weight: normal;"> How to Play </h1>
          <p>In Secret Roomle, your goal is to uncover the two secret rooms on today's floor! </p>
          <p>Click any empty space on the map to place a bomb where you think a secret room might be.</p>
          <p>If you find both the secret and the super secret room without running out of bombs, you win!</p>
          <p>Missed bombs reveal new information about the map such as room types and rocks blocking walls.</p>
          <p>Come back every day for a new challenge, or try endless mode to practice your knowledge.</p>
          <h1 style="color:white;font-weight: normal;"> Tips </h1>
          <p>The secret room is likely to be surrounded by many other rooms</p>
          <p>The super secret room is only connected to one normal room, and is often close to the boss or shop</p>
          <p>If a rock is on the wall of a room, that means it is blocking a secret room from spawning there</p>
          <p>For more detailed information about secret room generation, click <a href="https://bindingofisaacrebirth.wiki.gg/wiki/Secret_Room">here</a></p>
        </div>
      </div>
      <div id="aboutModal" class="modal">
        <div class="modal-content">
          <span class="close">&times;</span>
          <h1 style="color:white; font-weight: normal;"> About </h1>
          <p>I started this project initially as a simple clone of the TBOI room generation algorithm, as I was interested in how it all worked. I soon realised it would be really helpful to have a tool to practice my knowledge of secret rooms with, and from there came the idea of a daily game. Both are in this site - with the daily challenge and an endless mode for practice.</p>
          <p> The algorithm should be almost identical to the game ( with some simplifications ), so its a great tool to get intuition for secret room locations! I hope you have fun with the site, as it was a lot of fun making it :)</p>
          <p>This is just the first version, and more might be added in the future ( large rooms and ultra secret rooms to name a few ). If you have any feedback, bugs or feature requests please dm me on <a href="https://www.reddit.com/user/akqqa/">reddit</a>, and feel free to check out the <a href="https://github.com/Akqqa/Secret-Roomle">github</a> to see the spaghetti code.</p>
          <h1 style="color:white; font-weight: normal;"> Credits </h1>
          <p>Please note that this is a fan creation, and is not officially associated with The Binding of Isaac or its creators.</p>
          <p>Thanks to:</p>
          <ul>
            <li>My friend __ for helping me figure out how to make the frontend look decent!</li>
            <li><a href="https://isaacle.net">isaacle</a> for being the first to do an isaac based daily game, and for giving me inspiration on the look of the site</li>
            <li>The <a href="https://bindingofisaacrebirth.fandom.com/wiki/Level_Generation">Isaac wiki</a> for details on the level generation algorithm</li>
            <li><a href="https://www.boristhebrave.com/2020/09/12/dungeon-generation-in-binding-of-isaac/">boris the brave</a> for details on the level generation algorithm</li>
          </ul>
        </div>
      </div>
      <div style="display: flex; align-items: center; justify-content: space; flex-direction: column; box-sizing: border-box; background-color: rgb(152, 94, 81); padding-left: 1rem; padding-right: 1rem; padding-bottom: 1rem; border: 5px solid; border-color: rgb(179, 120, 106);"> <!-- Main Div  -->
        <h1 id="titleName" style="font-size: clamp(2.75rem, 5vw, 5rem); margin: 0; color: white; text-align: center; font-weight: normal;">Secret Roomle</h1>
        <p style="font-size: clamp(1.25rem, 5vw, 1.75rem); margin: 1rem 0;"><span id="floorname"></span>, <span id="cursename">no curse</span></p>
        <div style="display: flex; align-items: center; justify-content: center; flex-direction: column; gap: 1.25rem;"> <!-- Div containing main vertical content -->
          <p style="font-size: clamp(1.25rem, 5vw, 1.5rem); white-space: pre-line; align-self: flex-start; margin: 0 0 -1rem;">Bombs Remaining: <span id="guessesremaining"></span></p>
          <canvas id="gameCanvas" width="450" height="450" style="border: 5px solid; border-color: rgba(179, 120, 106); background-color: rgba(70, 39, 33, 0.3); "></canvas>
          <div class="buttons" style="display: flex; align-items: center; justify-content: space-evenly; flex-grow: 1; flex-direction: row; padding-bottom: 0rem; padding-top: 0.2rem; width:100%">
            <div class="image-button-container">
              <button id="howToPlayButton" class="image-button">
                How to Play
              </button>
            </div>
            <div class="image-button-container">
              <button class="image-button-2" style="text-shadow: 0 0 0px #B367B7;">
                Endless Mode
              </button>
            </div>
            <div id="aboutButton" class="image-button-container">
              <button class="image-button">
                About
              </button>
            </div>
            

          </div>
          <div id="countdownDiv" style="font-size: clamp(1.25rem, 5vw, 1.5rem); text-align: center;">
            <p style="margin: 0">New floor in <span id="countdown" >loading time...</span></p>
          </div>
          <div id="statsDiv"  style="font-size: clamp(1.25rem, 5vw, 1.5rem); text-align: center; margin-top: 0rem; border: 5px solid; border-color: rgb(179, 120, 106); padding-left: clamp(1rem, 4vw, 2rem); padding-right: clamp(1rem, 4vw, 2rem); background-color: rgba(70, 39, 33, 0.3)">
            <h1 style="font-size: clamp(2rem, 8vw, 3rem); margin-top: 0; color: white; font-weight: normal;">Lifetime Stats:</h1>
            <p>Games Played: <span id="gamesPlayed"></span></p>
            <p>Wins: <span id="gamesWon"></span></p>
            <p>Secret Rooms Found: <span id="secretRoomsFound"></span></p>
            <p>Super Secret Rooms Found: <span id="superSecretRoomsFound"></span></p>
            <p>Current Winstreak: <span id="currentWinstreak"></span></p>
            <p>Best Winstreak: <span id="bestWinstreak"></span></p>
          </div>
        </div> 
      </div>
    </div>
  
    <script type="module" src="main.js"></script>
    <!--Mobile detector script to fix bug with blurry background on mobile causing lag-->
    <script>
      const isMobile = /iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
      if (isMobile) {
        document.body.style.backdropFilter = 'none';
      }
    </script>
    <!--Modal logic - https://www.w3schools.com/howto/tryit.asp?filename=tryhow_css_modal-->
    <script>
      // Get the modal
      var modal1 = document.getElementById("howToPlayModal");
      var modal2 = document.getElementById("aboutModal");
      // Get the button that opens the modal
      var btn1 = document.getElementById("howToPlayButton");
      var btn2 = document.getElementById("aboutButton");
      // Get the <span> element that closes the modal
      var span1 = modal1.getElementsByClassName("close")[0];
      var span2 = modal2.getElementsByClassName("close")[0];
      const scrollTarget = window.innerHeight * 0.06;
      // When the user clicks the button, open the modal 
      btn1.onclick = function() {
        modal1.style.display = "block";
        if (window.scrollY > scrollTarget) {
          window.scrollTo({
            top: scrollTarget,
            behavior: "smooth"
          });
        }
        
      }
      btn2.onclick = function() {
        modal2.style.display = "block";
        if (window.scrollY > scrollTarget) {
          window.scrollTo({
            top: scrollTarget,
            behavior: "smooth"
          });
        }
      }
      
      // When the user clicks on <span> (x), close the modal
      span1.onclick = function() {
        modal1.style.display = "none";
      }
      span2.onclick = function() {
        modal2.style.display = "none";
      }
      
      // When the user clicks anywhere outside of the modal, close it
      window.onclick = function(event) {
        if (event.target == modal1) {
          modal1.style.display = "none";
        }
        if (event.target == modal2) {
          modal2.style.display = "none";
        }
      }
      </script>
  </body>
</html>
